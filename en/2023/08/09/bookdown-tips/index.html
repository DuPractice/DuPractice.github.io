<a name=top></a><!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Hugo-Du</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js></script><script src=https://cdn.jsdelivr.net/npm/vega@5.17.0></script><script src=https://cdn.jsdelivr.net/npm/vega-lite@4.17.0></script><script src=https://cdn.jsdelivr.net/npm/vega-embed@6.12.2></script><script>hljs.initHighlightingOnLoad();</script><link rel=icon href=https://dupractice.github.io/media/hugo-logo.png></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/media/hugo-logo.png width=50 height=50 alt=Hugo-ht></a><ul class=nav-links><li><a href=/>Home</a></li><li><a href=/en/projects/>Projects</a></li><li><a href=/en/research/>Research</a></li><li><a href=/en/blog/>Blog</a></li><li><a href=/cn/blog/>中文</a></li></ul></nav></header><main class=content role=main><div style=text-align:center><h1>test</h1><p>Xinting Du
/ 2023-08-09</p><hr></div><span class=article-toolbar><a href=https://github.com/DuPractice/DuPractice.github.io/edit/master/content/en/blog/test.md style=font-size:24px;color:#000 target=_blank><i class="fa fa-edit" aria-hidden=true title="Suggest an edit of this page"></i></a></span><aside class=toc>Table of Contents:<nav id=TableOfContents><ol><li><a href=#past>Past</a></li><li><a href=#package-readtext>Package readtext</a></li></ol></nav></aside><div class="body-text list-text"><h2 id=past>Past<a href=#past class=header-anchor arialabel=Anchor> #</a></h2><p>Reading text files is always the first step when analyzing the text data. However, it could be challenging. Before I get to know the <strong>package &lsquo;readtext&rsquo;</strong>, I used to write a loop to import data like the following code.</p><div class=highlight><pre style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=color:#408080;font-style:italic># Step one in this approach is grabbing the list of files. </span>
file.list<span style=color:#666>&lt;-</span><span style=color:#00f>list.files</span>()
file.list

<span style=color:#408080;font-style:italic># Step two in this approach is setting up the loop</span>
<span style=color:#00f>for</span>(i in <span style=color:#666>1</span><span style=color:#666>:</span><span style=color:#00f>length</span>(file.list)){
  
  temp<span style=color:#666>&lt;-</span><span style=color:#00f>import</span>(file.list[i])
  
  <span style=color:#00f>if</span>(i<span style=color:#666>==</span><span style=color:#666>1</span>){amdts<span style=color:#666>&lt;-</span>temp}
  	else{amdts<span style=color:#666>&lt;-</span><span style=color:#00f>bind_rows</span>(amdts,temp)}
  
  <span style=color:#00f>print</span>(<span style=color:#00f>paste</span>(<span style=color:#ba2121>&#34;Loading file&#34;</span>,i,<span style=color:#ba2121>&#34;of&#34;</span>,<span style=color:#00f>length</span>(file.list),sep<span style=color:#666>=</span><span style=color:#ba2121>&#34; &#34;</span>))
}

</code></pre></div><p>One advantage is that the for loop could also be applied on importing data more than text data. However, when importing text data via this way, it is inefficient.</p><h2 id=package-readtext>Package readtext<a href=#package-readtext class=header-anchor arialabel=Anchor> #</a></h2><p>This package could be really powerful if you have many individual files and did not combine them yet, or your data is in many formats and have many variables you want to keep them as covariates.</p><p>Here is the <a href=https://cran.r-project.org/web/packages/readtext/readtext.pdf target=_blank rel="noreferrer noopener">manual reference</a>
.</p><div class=highlight><pre style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=color:#408080;font-style:italic># ------ Data import ------ #</span>
<span style=color:#00f>getwd</span>()
data_dir <span style=color:#666>&lt;-</span> <span style=color:#ba2121>&#39;you project directory/&#39;</span> 

files <span style=color:#666>&lt;-</span> <span style=color:#00f>readtext</span>(<span style=color:#00f>paste0</span>(data_dir, <span style=color:#ba2121>&#34;DocName/*&#34;</span>), <span style=color:#408080;font-style:italic># here, we import the raw files, drawing document metadata from the file names</span>
<span style=color:#408080;font-style:italic># metadata, i.e. covariates</span>
                             docvarsfrom <span style=color:#666>=</span> <span style=color:#ba2121>&#34;filenames&#34;</span>, 
                             dvsep<span style=color:#666>=</span><span style=color:#ba2121>&#34;_&#34;</span>, 
                             docvarnames <span style=color:#666>=</span> <span style=color:#00f>c</span>(<span style=color:#ba2121>&#34;Name&#34;</span>, <span style=color:#ba2121>&#34;Session&#34;</span>, <span style=color:#ba2121>&#34;Year&#34;</span>, <span style=color:#ba2121>&#34;Actor&#34;</span>, <span style=color:#ba2121>&#34;Speech&#34;</span>))
                             
                             
<span style=color:#408080;font-style:italic># read .csv files</span>
files <span style=color:#666>&lt;-</span> <span style=color:#00f>readtext</span>( <span style=color:#00f>paste0</span>(data_dir, <span style=color:#ba2121>&#34;DocName/*&#34;</span>), text_field <span style=color:#666>=</span> <span style=color:#ba2121>&#39;texts&#39;</span>)                

<span style=color:#408080;font-style:italic># only read .txt files in a package</span>
<span style=color:#00f>readtext</span>(<span style=color:#00f>paste0</span>(data_dir, <span style=color:#ba2121>&#34;DocName/*.txt&#34;</span>))                          

</code></pre></div><p>The code will return a <em>data.frame</em> consisting of a columns doc_id and text that contain a document identifier and the texts respectively, with any additional columns consisting of document-level variables either found in the file containing the texts, or created through the readtext call.
Two advantages of using readtext.</p><p>Once we have a data.frame, it is easy to transfer it into a <em>tibble</em>, which could be used in <em>tidyverse</em>, <em>tidytext</em>, and etc.
Also, it could be transfered into corpus, which is used in <em>quanteda</em>.</p><div class=highlight><pre style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=color:#408080;font-style:italic># into tibble</span>

text_tibble <span style=color:#666>&lt;-</span> text_files <span style=color:#666>%&gt;%</span> 
	<span style=color:#00f>as_tibble</span>()

<span style=color:#408080;font-style:italic># into corpus</span>

text_corpus <span style=color:#666>&lt;-</span> text_files <span style=color:#666>%&gt;%</span>
	<span style=color:#00f>corprus</span>()
</code></pre></div><p style=color:#777>Last modified on 2023-08-10</p></div><a href=#top><i class="fa fa-chevron-up" style=font-size:30px;color:#000></i></a></main><footer class=footer><script src=https://utteranc.es/client.js repo=DuPractice/DuPractice.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><script type=text/javascript src=/js/math-code.js></script><script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=text/javascript src=/js/center-img.js></script><ul class=footer-links><li><a href=/en/blog/index.xml type=application/rss+xml title="RSS feed">Subscribe</a></li><li><a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>License
<i class="fa fa-cc" aria-hidden=true title="Attribution-NonCommercial-ShareAlike 4.0 International"></i></a></li></ul><div class=copyright-text>©
Xinting Du
2023-2024</div></footer>